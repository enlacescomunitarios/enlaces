/*!
 * auhtor: Luis Eduardo Miranda Barja
 * (C) 2015 - mbarjaedu13@gmail.com
 */
$(function(){$(".message-menu, .sms-catalog").addClass("active");$("#back, .back").on({click:function(f){f.preventDefault();location.href="/mensajes/gestion";}});var c=$("input[name=nro_control]"),a=c.closest(".form-group"),b=$(a).find(".form-control-feedback");$("#tipo").on({change:function(g){var f=+$(this).val();c.val("");a.removeClass("has-success has-error");b.removeClass("fa-check fa-times");if(f==5){c.attr("name","titulo").removeClass("only_msg_number").addClass("only_g_names").prev().text("TÃ­tulo:").end();}else{c.attr("name","nro_control").removeClass("only_g_names").addClass("only_msg_number").prev().text("Nro. de Control:").end();}}});$(".fileinput").fileinput();var d=$("input[name=audio]");$("form").on({submit:function(i){i.preventDefault();i.stopPropagation();var f=$(this),h=new FormData(),g=$("button[type=submit]");g.disable().hide();if(d.val().length){$.post("/mensajes/adicionar_msj",data=f.form2Dict(),function(e){if(e.status==true){h.append("tipo",data.tipo);h.append("nro",data.nro_control);h.append("audio",d[0].files[0]);h.append("audioname",e.audio);$.ajax({url:"190.129.142.26:8000/getaudiofile",type:"POST",data:h,mimeType:"multipart/form-data",contentType:false,cache:false,processData:false,success:function(j){if(j){location.href="/mensajes/gestion";}else{a.removeClass("has-success").addClass("has-error");b.removeClass("fa-check").addClass("fa-times");g.enable().show();}}});}else{a.removeClass("has-success").addClass("has-error");b.removeClass("fa-check").addClass("fa-times");g.enable().show();}});}else{g.enable().show();}}});});